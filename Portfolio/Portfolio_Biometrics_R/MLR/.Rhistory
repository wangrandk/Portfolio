setwd("C:/Users/RAN/OneDrive/Documents/BioDataAnalysis/Data/MLR")
prostate <- read.table("prostatedata.txt", header = TRUE,
sep = ";", dec = ",")
head(prostate)
summary(prostate)
dim(prostate)
prostate1<-prostate[,-c(1,11)]
lm1 <- lm(lpsa ~ ., data = prostate1)
par(mfrow=c(2,3))
plot(lm1,1:6)
lm12<-step(lm1)
drop1(lm12,test="F")
drop1(lm13<-update(lm12,~.-1),test="F")
drop1(lm14<-update(lm13,~.-age),test="F")
logLik(lm14)
lm2 <- lm(lpsa ~ .^2, data = prostate1)
plot(lm2,1:6)
boxplot(prostate3[1:9])
lm2 <- lm(lpsa ~ .^2, data = prostate3)
lm2 <- lm(lpsa ~ .^2, data = prostate1)
lm3<-step(lm2)
drop1(lm3,test="F")
drop1(lm4<-update(lm3,~.-1),test="F")
summary(lm2)
summary(lm3)
lm2 <- lm(lpsa ~ .^2, data = prostate1)
summary(lm2)
lm3<-step(lm2)
summary(lm3)
lm3<-step(lm2)
drop1(lm4<-update(lm3,~.-lcavol:pgg45),test="F")
drop1(lm4<-update(lm3,~.-lcp:pgg45),test="F")
drop1(lm5<-update(lm4,~.-lcavol:pgg45),test="F")
summary(lm5)
par(mfrow=c(2,2))
plot(lm5)
summary(lm5)
AIC(lm4)
AIC(lm5)
summary(lm4)
AIC(lm4)
summary(lm5)
lm1 <- lm(lpsa ~ ., data = prostate1)
summary(lm1)
par(mfrow=c(2,3))
plot(lm1,1:6)
lm12<-step(lm1)
drop1(lm12,test="F")
drop1(lm13<-update(lm12,~.-age),test="F")
drop1(lm14<-update(lm13,~.-lbph),test="F")
logLik(lm14)
2*9-2*logLik(lm15) #2* totol no. of varables - 2*loglik(model)
2*9-2*logLik(lm14) #2* totol no. of varables - 2*loglik(model)
AIC(lm15)
AIC(lm14)
2*9-2*logLik(lm14) #2* totol no. of varables - 2*loglik(model)
2*7-2*logLik(lm14) #2* totol no. of varables - 2*loglik(model)
2*6-2*logLik(lm14) #2* totol no. of varables - 2*loglik(model)
2*5-2*logLik(lm14) #2* totol no. of varables - 2*loglik(model)
summary(lm14)
AIC(lm14)
drop1(lm14<-update(lm13,~.-lbph),test="F")
drop1(lm15<-update(lm14,~.-svi),test="F")
logLik(lm15)
2*5-2*logLik(lm15) #2* totol no. of varables - 2*loglik(model)
summary(lm14)
summary(lm15)
library(reshape2)
library(ggplot2)
prostate1$residuals<-resid(lm14)
prostate2 <- melt(prostate1, measure.vars=c(1:4,6,8))
p <- ggplot(prostate2, aes(value, residuals))
p <- p + geom_point(shape=1)
p <- p + geom_smooth(method = lm) #loess
p <- p + facet_wrap(~ variable, scales="free")
print(p)
prostate1$residuals<-resid(lm14)
prostate2 <- melt(prostate1, measure.vars=c(1:4,6,8))
p <- ggplot(prostate2, aes(value, residuals))
p <- p + geom_point(shape=1)
p <- p + geom_smooth(method = loess) #loess
p <- p + facet_wrap(~ variable, scales="free")
print(p)
prostate1$residuals<-resid(lm5)
prostate2 <- melt(prostate1, measure.vars=c(1:4,6,8))
p <- ggplot(prostate2, aes(value, residuals))
p <- p + geom_point(shape=1)
p <- p + geom_smooth(method = lm) #loess
p <- p + facet_wrap(~ variable, scales="free")
print(p)
prostate1$residuals<-resid(lm5)
prostate2 <- melt(prostate1, measure.vars=c(1:4,6,8))
p <- ggplot(prostate2, aes(value, residuals))
p <- p + geom_point(shape=1)
p <- p + geom_smooth(method = loess) #loess
p <- p + facet_wrap(~ variable, scales="free")
print(p)
interaction.plot(prostate1$lweight, prostate1$lbph, prostate1$lpsa)
interaction.plot(prostate1$lweight, prostate1$lbph, prostate1$lpsa)
library(lattice)
d3 <- data.frame(prostate1)
contourplot(lpsa ~ lweight+lbph, data=d3)
d3 <- data.frame(prostate1)
contourplot(lpsa ~ lweight+lbph, data=d3)
contourplot(lpsa ~ lweight+lbph, data=d3)
contourplot(lpsa ~ lweight+lbph, cuts=20, region = TRUE)
contourplot(lpsa ~ lweight+lbph, cuts=20, region = TRUE)
prostate1
contourplot(lpsa ~ lweight+lbph, data=d3)
contourplot(qlogis(lpsa) ~lweight+lbph, data=d3, pretty=TRUE, region = TRUE)
library(lattice)
library(gplots)
install.packages("gplots")
library(gplots)
filled.contour(prostate1, main="Protein-Protein Interaction Potential")
library(xtable)
capture.output(print(xtable(cor(saltdata)),type="html"),file="cortable.html")
